<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Anonymous Chat</title>
<style>
body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; padding: 20px; }
#chat { border: 1px solid #ccc; height: 300px; overflow-y: auto; padding: 10px; }
#msg { width: 80%; }
</style>
</head>
<body>
<h1>Anonymous Chat</h1>
<div id="chat"></div>
<form id="form">
  <input id="msg" autocomplete="off" placeholder="Type a message..." /><button>Send</button>
</form>
<script src="/socket.io/socket.io.js"></script>
<script>
let username = '';
const socket = io();
const chat = document.getElementById('chat');
const form = document.getElementById('form');
const msgInput = document.getElementById('msg');

socket.on('username', (name) => {
  username = name;
  chat.innerHTML += `<div><em>You are <b>${username}</b></em></div>`;
});

socket.on('message', (data) => {
  const self = data.username === username;
  chat.innerHTML += `<div><b>${data.username}</b>: ${data.text}</div>`;
  chat.scrollTop = chat.scrollHeight;
});

form.addEventListener('submit', function(e) {
  e.preventDefault();
  const text = msgInput.value.trim();
  if (text) {
    socket.emit('message', text);
    msgInput.value = '';
  }
});
</script>
</body>
</html>
